# Euler and Euler-Maruyama Integration Schemes

## 1. Euler Method for Ordinary Differential Equations (ODEs)

The **Euler method** (forward Euler) is the most basic explicit numerical method for approximating solutions to first-order ordinary differential equations:

$\frac{dy}{dt} = f(t, y), \quad y(t_0) = y_0$

### Update Rule
$y_{n+1} = y_n + h \cdot f(t_n, y_n)$
where $\(h\)$ is the fixed step size, and $\(t_n = t_0 + n h\)$.

### Geometric Interpretation
The method uses the derivative (slope) at the current point $\((t_n, y_n)\)$ to extrapolate linearly to the next point. This creates a piecewise linear (polygonal) approximation to the true solution curve.

<grok-card data-id="7d6715" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="4c0d6c" data-type="image_card"  data-arg-size="LARGE" ></grok-card>


### Error Analysis
- **Local truncation error**: $\(O(h^2)\)$ (error introduced in a single step, assuming exact starting point).
- **Global error**: $\(O(h)\)$ (accumulated error over a fixed interval).
- The method is **first-order accurate**.

### Limitations
For stiff equations or large step sizes, the method can become unstable (errors grow exponentially).

<grok-card data-id="973e5f" data-type="image_card"  data-arg-size="LARGE" ></grok-card>


## 2. Euler-Maruyama Method for Stochastic Differential Equations (SDEs)

The **Euler-Maruyama method** extends the Euler method to Itô stochastic differential equations:

$dX_t = a(t, X_t) \, dt + b(t, X_t) \, dW_t, \quad X(t_0) = X_0$

where $\(a\)$ is the drift term, $\(b\)$ is the diffusion term, and $\(W_t\)$ is a standard Wiener process (Brownian motion).

### Update Rule

$X_{n+1} = X_n + a(t_n, X_n) \cdot h + b(t_n, X_n) \cdot \Delta W_n$

with $\(\Delta W_n \sim \mathcal{N}(0, h)\)$ (independent Gaussian increments).

### Key Properties
- Adds a stochastic increment scaled by the diffusion coefficient.
- Simulates discrete paths that approximate continuous stochastic trajectories.

<grok-card data-id="962c1f" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="a27a9f" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="081024" data-type="image_card"  data-arg-size="LARGE" ></grok-card>


### Convergence
- **Strong convergence**: Order 0.5 (measures pathwise deviation: $\(\mathbb{E}[|X_T - X_N|] \leq C h^{0.5}\))$.
- **Weak convergence**: Order 1.0 (approximates moments and distributions well).

## 3. Comparison with Higher-Order Schemes

### For ODEs: Euler vs. Runge-Kutta Methods

Higher-order Runge-Kutta methods sample the derivative at multiple points within each interval to reduce truncation error.

Example: Classic **fourth-order Runge-Kutta (RK4)**

<grok-card data-id="bb88c8" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="decb9e" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="84a7fa" data-type="image_card"  data-arg-size="LARGE" ></grok-card>


| Scheme          | Global Order | Evaluations per Step | Stability                  | Typical Use                          |
|-----------------|--------------|----------------------|----------------------------|--------------------------------------|
| Euler           | 1            | 1                    | Poor (explicit)            | Teaching, very rough estimates       |
| Heun / RK2      | 2            | 2                    | Moderate                   | Simple improvement over Euler        |
| RK4             | 4            | 4                    | Good for non-stiff         | Standard for accurate ODE solving    |
| Adaptive RK45   | 4–5          | Variable             | Excellent                  | Production code (auto step control) |

### For SDEs: Euler-Maruyama vs. Milstein and Others

The **Milstein method** adds a correction for the stochastic integral when \(b\) depends on \(X\):

$X_{n+1} = X_n + a h + b \Delta W_n + \frac{1}{2} b \frac{\partial b}{\partial x} \left( (\Delta W_n)^2 - h \right)$

This achieves **strong order 1.0**.

<grok-card data-id="e649fa" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="f2c135" data-type="image_card"  data-arg-size="LARGE" ></grok-card>


| Scheme              | Strong Order | Weak Order | Extra Computation                  | When to Use                              |
|---------------------|--------------|------------|------------------------------------|------------------------------------------|
| Euler-Maruyama      | 0.5          | 1.0        | None                               | Quick prototyping, weak accuracy needed  |
| Milstein            | 1.0          | 1.0        | Derivative of \(b\)                | State-dependent diffusion, path accuracy |
| Stochastic RK       | ≥1.0         | ≥1.5       | Multiple stages                    | High-precision simulations               |

## Summary and Recommendations

- **Euler method**: Ideal for understanding numerical integration basics but rarely used in practice due to low accuracy.
- **Euler-Maruyama**: The standard starting point for SDE simulation (e.g., in finance for option pricing paths).
- For serious work:
  - ODEs → Use RK4 or adaptive methods (e.g., `scipy.integrate.solve_ivp` with method='RK45').
  - SDEs → Use Milstein if diffusion is state-dependent; otherwise Euler-Maruyama is often sufficient for weak properties.

Copy this entire markdown content and save it as `detailed_euler_schemes.md` for offline reference.



# Detailed Explanation of the Wiener Process

The **Wiener process**, also known as **standard Brownian motion**, is a fundamental continuous-time stochastic process in probability theory, mathematics, and physics. It serves as the mathematical model for random motion, such as the path of a particle in Brownian motion.

## Definition

A stochastic process $\( W_t \) (or \( W(t) \)) for \( t \geq 0 \)$ is a **standard Wiener process** (or standard Brownian motion) if it satisfies the following properties:

1. **Starting point**: $\( W_0 = 0 \)$ almost surely (the process starts at zero).
2. **Independent increments**: For any times $\( 0 \leq t_1 < t_2 < \cdots < t_n \)$, the increments $\( W_{t_2} - W_{t_1}, W_{t_3} - W_{t_2}, \dots, W_{t_n} - W_{t_{n-1}} \)$ are mutually independent.
3. **Normally distributed increments**: For any $\( s < t \)$, the increment $\( W_t - W_s \sim \mathcal{N}(0, t - s) \)$ (mean 0, variance equal to the time interval).
4. **Continuous paths**: The function $\( t \mapsto W_t \)$ is continuous almost surely (no jumps, though highly irregular).

<grok-card data-id="606232" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="50985f" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="944cf5" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="44432d" data-type="image_card"  data-arg-size="LARGE" ></grok-card>


*Typical sample paths of a Wiener process: random, jagged, and continuous trajectories starting at zero.*

## Key Properties and Consequences

- **Mean and Variance**:
  - $\( \mathbb{E}[W_t] = 0 \)$
  - $\( \{Var}(W_t) = t \)$
  - $\( \{Cov}(W_s, W_t) = \min(s, t) \)$

- **Self-similarity**: Scaling time by a factor $\( c > 0 \)$ and space by $\( \sqrt{c} \)$ yields the same process in distribution: $\( W_{ct} \stackrel{d}{=} \sqrt{c} \, W_t \)$.

- **Paths are nowhere differentiable**: Almost every sample path is continuous but extremely rough—no tangent exists anywhere.

- **Quadratic variation**: Over [0, t], the quadratic variation $\( \langle W \rangle_t = t \)$ almost surely (key for stochastic calculus).

- **Markov property**: Future behavior depends only on the current position (memoryless in increments).

<grok-card data-id="acb94e" data-type="image_card"  data-arg-size="LARGE" ></grok-card>



<grok-card data-id="693cbe" data-type="image_card"  data-arg-size="LARGE" ></grok-card>


*Illustrations of Wiener process properties, including variance growth and path irregularity.*

## Historical and Physical Context

Named after Norbert Wiener, who provided its rigorous mathematical foundation in the 1920s. Physically, it models the erratic motion of pollen particles in water observed by Robert Brown in 1827 (hence "Brownian motion").

## Role in Stochastic Calculus and SDEs

The Wiener process is the driving noise in Itô stochastic differential equations (SDEs):

$dX_t = \mu(t, X_t) \, dt + \sigma(t, X_t) \, dW_t$

The Euler-Maruyama method (discussed previously) discretizes such equations using increments $\( \Delta W_n \sim \mathcal{N}(0, \Delta t) \)$ sampled from the Wiener process.

## Simulation

In practice, approximate Wiener process paths by cumulative sums of independent Gaussian increments:

```python
import numpy as np
import matplotlib.pyplot as plt

dt = 0.001
T = 1.0
n = int(T / dt)
dW = np.random.normal(0, np.sqrt(dt), n)
W = np.cumsum(dW)
W = np.insert(W, 0, 0.0)  # Start at 0
t = np.linspace(0, T, n+1)
plt.plot(t, W)
'''
